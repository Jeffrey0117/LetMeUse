"use strict";(()=>{(function(){let M=document.currentScript;function U(){let e=M?.getAttribute("data-base-url");if(e)return e.replace(/\/+$/,"");let t=M?.getAttribute("src")??"";try{return new URL(t,window.location.href).origin}catch{return""}}let T=U();document.querySelectorAll("[data-lmu-id]").forEach(async e=>{let t=e.getAttribute("data-lmu-id");if(t)try{let i=await fetch(`${T}/api/serve/${t}`);if(!i.ok)return;let n=await i.json(),r=q(e),o={...n.style,...r},c={...n,style:o};F(e,c)}catch{}});function q(e){let t={backgroundColor:e.getAttribute("data-bg-color")??void 0,textColor:e.getAttribute("data-text-color")??void 0,fontSize:e.getAttribute("data-font-size")??void 0,ctaBackgroundColor:e.getAttribute("data-cta-bg-color")??void 0,ctaTextColor:e.getAttribute("data-cta-text-color")??void 0,borderRadius:e.getAttribute("data-border-radius")??void 0,padding:e.getAttribute("data-padding")??void 0,maxWidth:e.getAttribute("data-max-width")??void 0,textAlign:e.getAttribute("data-text-align")??void 0};return Object.fromEntries(Object.entries(t).filter(([,i])=>i!==void 0))}function s(e){let t=document.createElement("div");return t.textContent=e,t.innerHTML}function A(e){return e.startsWith("http")?e:`${T}${e}`}function j(e){return e?{backgroundImage:`url(${e.startsWith("http")?e:`${T}${e}`})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}:{}}function y(e,t){let i={backgroundColor:String(e.backgroundColor),color:String(e.textColor),borderRadius:String(e.borderRadius),padding:String(e.padding),maxWidth:String(e.maxWidth),fontSize:e.fontSize?String(e.fontSize):"16px",fontFamily:'-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif',boxSizing:"border-box",...j(t)};return e.textAlign&&(i.textAlign=String(e.textAlign)),i}function f(e){let t=e.style;return`<a href="${s(e.ctaUrl)}" target="_blank" rel="noopener noreferrer" style="display:inline-block;background:${t.ctaBackgroundColor};color:${t.ctaTextColor};padding:8px 20px;border-radius:6px;text-decoration:none;font-size:0.875em;font-weight:500;white-space:nowrap">${s(e.ctaText)}</a>`}function R(e){return`<button onclick="this.closest('[data-lmu-wrapper]').remove()" style="background:none;border:none;cursor:pointer;font-size:1.125em;line-height:1;opacity:0.7;padding:4px 8px;color:${e}">&#10005;</button>`}function z(e,t,i=""){let n=e.imageUrl;return n?`<img src="${s(A(n))}" alt="" style="max-width:100%;border-radius:4px;margin-bottom:8px;object-fit:cover;max-height:${t};${i}" />`:""}function $(){return window.innerWidth<640}function F(e,t){let i=t.category||"ad";if(i==="login-form")return D(e,t);if(i==="feedback-form")return N(e,t);switch(t.type){case"bottom-banner":return B(e,t);case"top-notification":return O(e,t);case"in-article-banner":return H(e,t);case"modal-popup":return P(e,t);case"sidebar-card":return W(e,t);default:return H(e,t)}}function B(e,t){let i=t.style,n=$(),r=document.createElement("div");r.setAttribute("data-lmu-wrapper",""),Object.assign(r.style,{...y(i,t.backgroundImageUrl),position:"fixed",bottom:"0",left:"0",right:"0",zIndex:String(i.zIndex),display:"flex",flexDirection:n?"column":"row",alignItems:n?"stretch":"center",gap:n?"12px":"16px",boxShadow:"0 -2px 8px rgba(0,0,0,0.15)"});let o="",c=t.imageUrl;c&&!n&&(o+=`<img src="${s(A(c))}" alt="" style="width:80px;height:60px;object-fit:cover;border-radius:4px;flex-shrink:0" />`),o+='<div style="flex:1;min-width:0">',o+=`<h3 style="margin:0 0 4px;font-size:1em;font-weight:600">${s(t.headline)}</h3>`;let u=t.bodyText;u&&(o+=`<p style="margin:0;font-size:0.8125em;opacity:0.85;line-height:1.4">${s(u)}</p>`),o+="</div>",n?o+=f(t).replace("display:inline-block","display:block;text-align:center;width:100%"):o+=f(t),r.innerHTML=o,document.body.appendChild(r)}function O(e,t){let i=t.style,n=$(),r=document.createElement("div");r.setAttribute("data-lmu-wrapper",""),Object.assign(r.style,{...y(i,t.backgroundImageUrl),position:"fixed",top:"0",left:"0",right:"0",zIndex:String(i.zIndex),display:"flex",flexDirection:n?"column":"row",alignItems:n?"stretch":"center",gap:n?"8px":"12px",padding:n?"12px 16px":"10px 16px",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"});let o="";n?(o+='<div style="display:flex;align-items:center;gap:8px">',o+=`<span style="flex:1;font-size:0.875em;font-weight:500">${s(t.headline)}</span>`,o+=R(String(i.textColor)),o+="</div>",o+=f(t).replace("display:inline-block","display:block;text-align:center;width:100%").replace("padding:8px 20px","padding:8px 16px")):(o+=`<span style="flex:1;font-size:0.875em;font-weight:500">${s(t.headline)}</span>`,o+=f(t).replace("padding:8px 20px","padding:6px 16px").replace("font-size:0.875em","font-size:0.8125em"),o+=R(String(i.textColor))),r.innerHTML=o,document.body.appendChild(r)}function H(e,t){let i=t.style,n=$(),r=document.createElement("div");r.setAttribute("data-lmu-wrapper",""),Object.assign(r.style,{...y(i,t.backgroundImageUrl),boxShadow:"0 1px 3px rgba(0,0,0,0.12)"});let o=z(t,n?"150px":"200px","width:100%");o+=`<h3 style="margin:0 0 6px;font-size:1.125em;font-weight:600">${s(t.headline)}</h3>`;let c=t.bodyText;c&&(o+=`<p style="margin:0 0 12px;font-size:0.875em;opacity:0.85;line-height:1.5">${s(c)}</p>`),n?o+=f(t).replace("display:inline-block","display:block;text-align:center;width:100%"):o+=f(t),r.innerHTML=o,e.appendChild(r)}function P(e,t){let i=t.style,n=$(),r=document.createElement("div");r.setAttribute("data-lmu-wrapper",""),Object.assign(r.style,{position:"fixed",top:"0",left:"0",right:"0",bottom:"0",backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:String(i.zIndex),padding:n?"16px":"0"});let o=document.createElement("div"),c=y(i,t.backgroundImageUrl);n&&(c.padding="16px"),Object.assign(o.style,{...c,maxWidth:"400px",width:n?"100%":"90%",position:"relative",boxShadow:"0 8px 32px rgba(0,0,0,0.3)"});let u=`<div style="position:absolute;top:8px;right:8px">${R(String(i.textColor))}</div>`;u+=z(t,n?"140px":"180px","width:100%"),u+=`<h3 style="margin:0 0 8px;font-size:${n?"1.125em":"1.25em"};font-weight:600">${s(t.headline)}</h3>`;let m=t.bodyText;m&&(u+=`<p style="margin:0 0 16px;font-size:0.875em;opacity:0.85;line-height:1.5">${s(m)}</p>`),u+=f(t).replace("display:inline-block","display:block;text-align:center;width:100%"),o.innerHTML=u,r.appendChild(o),r.addEventListener("click",b=>{b.target===r&&r.remove()}),document.body.appendChild(r)}function W(e,t){let i=t.style,n=$(),r=document.createElement("div");r.setAttribute("data-lmu-wrapper",""),Object.assign(r.style,{...y(i,t.backgroundImageUrl),maxWidth:n?"100%":"280px",boxShadow:"0 1px 3px rgba(0,0,0,0.12)"});let o=z(t,n?"120px":"160px","width:100%");o+=`<h3 style="margin:0 0 6px;font-size:1em;font-weight:600">${s(t.headline)}</h3>`;let c=t.bodyText;c&&(o+=`<p style="margin:0 0 12px;font-size:0.8125em;opacity:0.85;line-height:1.4">${s(c)}</p>`),o+=f(t).replace("display:inline-block","display:block;text-align:center;width:100%;font-size:0.8125em"),r.innerHTML=o,e.appendChild(r)}function E(e){return`width:100%;padding:10px 12px;border:1px solid ${e}20;border-radius:6px;font-size:14px;background:transparent;color:${e};box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif`}function I(e,t){return`display:block;width:100%;padding:10px;margin-top:16px;background:${e};color:${t};border:none;border-radius:6px;font-size:14px;font-weight:600;cursor:pointer;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif`}function D(e,t){let i=t.style,n=t.widgetConfig||{},r=document.createElement("div");r.setAttribute("data-lmu-wrapper",""),Object.assign(r.style,{...y(i),boxShadow:"0 1px 3px rgba(0,0,0,0.12)"});let o=s(n.title||"Login"),c=n.subtitle,u=s(n.submitText||"Sign In"),m=n.submitUrl||"",b=n.successRedirect||"",L=n.fields||[{name:"email",type:"email",label:"Email",placeholder:"your@email.com",required:!0},{name:"password",type:"password",label:"Password",placeholder:"",required:!0}],v=n.showSocialLogins,d=n.socialLogins||[],C=n.showRegisterLink,S=n.registerUrl||"#",l=n.showForgotPassword,x=n.forgotPasswordUrl||"#",p=String(i.textColor),a=`<h3 style="margin:0 0 4px;font-size:20px;font-weight:600">${o}</h3>`;c&&(a+=`<p style="margin:0 0 16px;font-size:14px;opacity:0.7">${s(c)}</p>`),a+=`<form data-lmu-form action="${s(m)}" data-redirect="${s(b)}" style="display:flex;flex-direction:column;gap:12px">`;for(let g of L){let h=s(g.label),k=g.required?'<span style="color:#ef4444;margin-left:2px">*</span>':"";a+="<div>",a+=`<label style="display:block;font-size:13px;font-weight:500;margin-bottom:4px">${h}${k}</label>`,a+=`<input type="${g.type}" name="${g.name}" placeholder="${s(g.placeholder||"")}" ${g.required?"required":""} style="${E(p)}" />`,a+="</div>"}if(a+=`<button type="submit" style="${I(String(i.ctaBackgroundColor),String(i.ctaTextColor))}">${u}</button>`,a+="</form>",v&&d.length>0){a+=`<div style="margin-top:16px;padding-top:16px;border-top:1px solid ${p}15;display:flex;flex-direction:column;gap:8px">`;let g={google:"Google",github:"GitHub",facebook:"Facebook"},h={google:"#ea4335",github:"#333",facebook:"#1877f2"};for(let k of d){let _=g[k]||k,G=h[k]||"#666";a+=`<button type="button" style="display:block;width:100%;padding:10px;background:transparent;border:1px solid ${p}20;border-radius:6px;font-size:13px;cursor:pointer;color:${p};font-family:-apple-system,BlinkMacSystemFont,sans-serif"><span style="color:${G};font-weight:600">${s(_)}</span></button>`}a+="</div>"}(C||l)&&(a+='<div style="margin-top:12px;display:flex;justify-content:space-between;font-size:12px">',C&&(a+=`<a href="${s(S)}" style="color:${i.ctaBackgroundColor};text-decoration:none">Create account</a>`),l&&(a+=`<a href="${s(x)}" style="color:${p};opacity:0.6;text-decoration:none">Forgot password?</a>`),a+="</div>"),r.innerHTML=a,e.appendChild(r);let w=r.querySelector("[data-lmu-form]");w&&m&&w.addEventListener("submit",async g=>{g.preventDefault();let h=Object.fromEntries(new FormData(w));try{(await fetch(m,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)})).ok&&b&&(window.location.href=b)}catch{}})}function N(e,t){let i=t.style,n=t.widgetConfig||{},r=document.createElement("div");r.setAttribute("data-lmu-wrapper",""),Object.assign(r.style,{...y(i),boxShadow:"0 1px 3px rgba(0,0,0,0.12)"});let o=s(n.title||"Feedback"),c=n.subtitle,u=s(n.submitText||"Send Feedback"),m=n.submitUrl||"",b=s(n.successMessage||"Thank you for your feedback!"),L=n.fields||[{name:"name",type:"text",label:"Name",placeholder:"Your name",required:!0},{name:"email",type:"email",label:"Email",placeholder:"your@email.com",required:!0},{name:"message",type:"textarea",label:"Message",placeholder:"Your feedback...",required:!0}],v=String(i.textColor),d=`<h3 style="margin:0 0 4px;font-size:20px;font-weight:600">${o}</h3>`;c&&(d+=`<p style="margin:0 0 16px;font-size:14px;opacity:0.7">${s(c)}</p>`),d+=`<form data-lmu-form action="${s(m)}" data-success="${b}" style="display:flex;flex-direction:column;gap:12px">`;for(let l of L){let x=s(l.label),p=l.required?'<span style="color:#ef4444;margin-left:2px">*</span>':"";if(d+="<div>",d+=`<label style="display:block;font-size:13px;font-weight:500;margin-bottom:4px">${x}${p}</label>`,l.type==="rating"){d+=`<div data-lmu-rating="${l.name}" style="display:flex;gap:4px">`;for(let a=1;a<=5;a++)d+=`<span data-star="${a}" style="font-size:24px;cursor:pointer;opacity:0.3;color:#f59e0b">&#9733;</span>`;d+=`<input type="hidden" name="${l.name}" value="0" />`,d+="</div>"}else l.type==="textarea"?d+=`<textarea name="${l.name}" placeholder="${s(l.placeholder||"")}" ${l.required?"required":""} rows="3" style="${E(v)};resize:vertical;font-family:-apple-system,BlinkMacSystemFont,sans-serif"></textarea>`:d+=`<input type="${l.type}" name="${l.name}" placeholder="${s(l.placeholder||"")}" ${l.required?"required":""} style="${E(v)}" />`;d+="</div>"}d+=`<button type="submit" style="${I(String(i.ctaBackgroundColor),String(i.ctaTextColor))}">${u}</button>`,d+="</form>",r.innerHTML=d,e.appendChild(r),r.querySelectorAll("[data-lmu-rating]").forEach(l=>{let x=l.querySelectorAll("[data-star]"),p=l.querySelector('input[type="hidden"]');x.forEach(a=>{a.addEventListener("click",()=>{let w=Number(a.getAttribute("data-star"));p&&(p.value=String(w)),x.forEach(g=>{let h=Number(g.getAttribute("data-star"));g.style.opacity=h<=w?"1":"0.3"})})})});let S=r.querySelector("[data-lmu-form]");S&&S.addEventListener("submit",async l=>{l.preventDefault();let x=Object.fromEntries(new FormData(S));if(m)try{await fetch(m,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)})}catch{}let p=r.querySelector("[data-lmu-form]");p&&(p.innerHTML=`<div style="text-align:center;padding:24px 0"><p style="font-size:1.25em;font-weight:600;margin:0 0 8px">&#10003;</p><p style="margin:0;font-size:14px;opacity:0.85">${b}</p></div>`)})}})();})();
